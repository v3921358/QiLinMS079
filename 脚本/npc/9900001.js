/*
 ZEVMS冒险岛(079)游戏服务端
 神秘商人
 */
var ca = java.util.Calendar.getInstance();
var year = ca.get(java.util.Calendar.YEAR);
var month = ca.get(java.util.Calendar.MONTH) + 1;
var day = ca.get(java.util.Calendar.DATE);
var hour = ca.get(java.util.Calendar.HOUR_OF_DAY);
var minute = ca.get(java.util.Calendar.MINUTE);
var second = ca.get(java.util.Calendar.SECOND);
var weekday = ca.get(java.util.Calendar.DAY_OF_WEEK);

var 说明文字 = "   hi #b#h ##k 你竟然能找到我，说明你还是有点本事的，我是这个冒险岛世界的神秘商人，你不一定每次都能找到我的。";
//物品代码，物品数量，物品金币，物品点券，出现时间
var 贩售物品 = [
	//头盔防御必成卷
	[2040006, 1, 20000*10000, 50*10000, 1],
	[2040006, 1, 20000*10000, 50*10000, 3],
	[2040006, 3, 20000*10000, 50*10000, 4],
	[2040006, 1, 20000*10000, 50*10000, 5],
	[2040006, 1, 20000*10000, 50*10000, 9],
	[2040006, 2, 20000*10000, 50*10000, 11],
	[2040006, 1, 20000*10000, 50*10000, 13],
	//头盔体力必成卷
	[2040007, 1, 20000*10000, 50*10000, 1],
	[2040007, 1, 20000*10000, 50*10000, 2],
	[2040007, 3, 20000*10000, 50*10000, 3],
	[2040007, 1, 20000*10000, 50*10000, 4],
	[2040007, 1, 20000*10000, 50*10000, 5],
	[2040007, 2, 20000*10000, 50*10000, 6],
	[2040007, 1, 20000*10000, 50*10000, 7],
	//耳环智力必成卷
	[2040303, 1, 20000*10000, 50*10000, 3],
	[2040303, 1, 20000*10000, 50*10000, 5],
	[2040303, 3, 20000*10000, 50*10000, 7],
	[2040303, 1, 20000*10000, 50*10000, 9],
	[2040303, 1, 20000*10000, 50*10000, 11],
	[2040303, 2, 20000*10000, 50*10000, 13],
	[2040303, 1, 20000*10000, 50*10000, 15],
	//上衣防御必成卷
	[2040403, 1, 20000*10000, 50*10000, 11],
	[2040403, 2, 20000*10000, 50*10000, 13],
	[2040403, 1, 20000*10000, 50*10000, 15],
	[2040403, 1, 20000*10000, 50*10000, 17],
	[2040403, 1, 20000*10000, 50*10000, 19],
	[2040403, 3, 20000*10000, 50*10000, 21],
	[2040403, 1, 20000*10000, 50*10000, 23],
	//全身盔甲敏捷必成卷
	[2040506, 1, 30000*10000, 50*10000, 12],
	[2040506, 2, 30000*10000, 50*10000, 13],
	[2040506, 1, 20000*10000, 50*10000, 14],
	[2040506, 1, 30000*10000, 50*10000, 15],
	[2040506, 1, 30000*10000, 50*10000, 16],
	[2040506, 2, 30000*10000, 50*10000, 17],
	[2040506, 1, 20000*10000, 50*10000, 18],
	//全身盔甲防御必成卷
	[2040507, 1, 30000*10000, 50*10000, 2],
	[2040507, 2, 30000*10000, 50*10000, 3],
	[2040507, 1, 20000*10000, 50*10000, 4],
	[2040507, 1, 30000*10000, 50*10000, 5],
	[2040507, 1, 30000*10000, 50*10000, 16],
	[2040507, 2, 30000*10000, 50*10000, 17],
	[2040507, 2, 20000*10000, 50*10000, 18],
	//裤裙防御必成卷
	[2040603, 1, 30000*10000, 50*10000, 22],
	[2040603, 2, 30000*10000, 50*10000, 23],
	[2040603, 1, 40000*10000, 50*10000, 14],
	[2040603, 1, 30000*10000, 50*10000, 15],
	[2040603, 1, 30000*10000, 50*10000, 16],
	[2040603, 2, 30000*10000, 50*10000, 17],
	[2040603, 2, 20000*10000, 50*10000, 18],
	//鞋子敏捷必成卷
	[2040709, 1, 30000*10000, 50*10000, 12],
	[2040709, 2, 30000*10000, 50*10000, 13],
	[2040709, 1, 20000*10000, 50*10000, 14],
	[2040709, 1, 30000*10000, 50*10000, 15],
	[2040709, 1, 30000*10000, 50*10000, 16],
	[2040709, 2, 30000*10000, 50*10000, 17],
	[2040709, 1, 40000*10000, 50*10000, 18],
	//鞋子跳跃必成卷
	[2040710, 1, 40000*10000, 50*10000, 11],
	[2040710, 2, 20000*10000, 50*10000, 13],
	[2040710, 1, 40000*10000, 50*10000, 15],
	[2040710, 1, 20000*10000, 50*10000, 17],
	[2040710, 1, 40000*10000, 50*10000, 19],
	[2040710, 2, 20000*10000, 50*10000, 21],
	[2040710, 1, 40000*10000, 50*10000, 23],
	//鞋子速度必1成卷
	[2040711, 1, 40000*10000, 50*10000, 1],
	[2040711, 2, 20000*10000, 50*10000, 3],
	[2040711, 1, 40000*10000, 50*10000, 5],
	[2040711, 1, 20000*10000, 50*10000, 7],
	[2040711, 1, 40000*10000, 50*10000, 9],
	[2040711, 1, 20000*10000, 50*10000, 21],
	[2040711, 2, 40000*10000, 50*10000, 23],
	//手套敏捷必成卷
	[2040806, 1, 40000*10000, 50*10000, 1],
	[2040806, 2, 20000*10000, 30*10000, 3],
	[2040806, 1, 40000*10000, 50*10000, 5],
	[2040806, 1, 30000*10000, 50*10000, 7],
	[2040806, 1, 40000*10000, 30*10000, 9],
	[2040806, 1, 20000*10000, 50*10000, 11],
	[2040806, 2, 40000*10000, 30*10000, 13],
	//盾牌防御必成卷
	[2040903, 1, 40000*10000, 50*10000, 1],
	[2040903, 2, 20000*10000, 30*10000, 3],
	[2040903, 1, 40000*10000, 50*10000, 5],
	[2040903, 1, 40000*10000, 50*10000, 11],
	[2040903, 2, 20000*10000, 30*10000, 17],
	[2040903, 1, 40000*10000, 50*10000, 19],
	//披风魔法防御必成卷
	[2041024, 1, 40000*10000, 50*10000, 1],
	[2041024, 2, 20000*10000, 30*10000, 3],
	[2041024, 1, 40000*10000, 50*10000, 5],
	[2041024, 1, 40000*10000, 50*10000, 11],
	[2041024, 2, 20000*10000, 30*10000, 17],
	[2041024, 3, 40000*10000, 50*10000, 23],
	//披风物理防御必成卷
	[2041025, 2, 20000*10000, 30*10000, 13],
	[2041025, 1, 40000*10000, 50*10000, 15],
	[2041025, 1, 40000*10000, 50*10000, 11],
	[2041025, 2, 20000*10000, 30*10000, 17],
	[2041025, 3, 40000*10000, 50*10000, 23],
	//单手剑攻击必成卷
	[2043003, 2, 50000*10000, 50*10000, 11],
	[2043003, 1, 40000*10000, 30*10000, 17],
	[2043003, 1, 40000*10000, 50*10000, 19],
	//单手斧攻击必成卷
	[2043103, 2, 50000*10000, 50*10000, 12],
	[2043103, 1, 40000*10000, 30*10000, 13],
	[2043103, 3, 40000*10000, 50*10000, 14],
	//单手钝器攻击必成卷
	[2043203, 2, 30000*10000, 50*10000, 12],
	[2043203, 1, 40000*10000, 30*10000, 13],
	[2043203, 3, 40000*10000, 50*10000, 14],
	//短剑攻击必成卷
	[2043303, 1, 30000*10000, 50*10000, 17],
	[2043303, 1, 40000*10000, 30*10000, 18],
	[2043303, 1, 40000*10000, 50*10000, 19],
	//短杖攻击必成卷
	[2043703, 1, 30000*10000, 50*10000, 17],
	[2043703, 1, 40000*10000, 30*10000, 18],
	[2043703, 1, 40000*10000, 50*10000, 19],
	//长杖攻击必成卷
	[2043803, 1, 40000*10000, 50*10000, 19],
	[2043803, 1, 40000*10000, 30*10000, 20],
	[2043803, 1, 40000*10000, 50*10000, 21],
	//双手剑攻击必成卷
	[2044003, 1, 40000*10000, 50*10000, 21],
	[2044003, 2, 40000*10000, 30*10000, 22],
	[2044003, 1, 40000*10000, 50*10000, 2],
	//双手剑魔力必成卷
	[2044019, 1, 40000*10000, 50*10000, 3],
	[2044019, 2, 40000*10000, 30*10000, 4],
	[2044019, 1, 40000*10000, 50*10000, 5],
	//双手斧攻击必成卷
	[2044103, 1, 40000*10000, 50*10000, 13],
	[2044103, 2, 40000*10000, 30*10000, 14],
	[2044103, 1, 40000*10000, 50*10000, 15],
	//双手钝器攻击必成卷
	[2044203, 1, 40000*10000, 50*10000, 1],
	[2044203, 2, 40000*10000, 30*10000, 2],
	[2044203, 1, 40000*10000, 50*10000, 3],
	[2044203, 1, 40000*10000, 50*10000, 4],
	[2044203, 2, 40000*10000, 30*10000, 5],
	[2044203, 1, 40000*10000, 50*10000, 6],
	[2044203, 1, 40000*10000, 50*10000, 7],
	[2044203, 2, 40000*10000, 30*10000, 8],
	[2044203, 1, 40000*10000, 50*10000, 9],
	[2044203, 1, 40000*10000, 50*10000, 10],
	[2044203, 2, 40000*10000, 30*10000, 11],
	[2044203, 1, 40000*10000, 50*10000, 12],
	[2044203, 1, 40000*10000, 50*10000, 13],
	[2044203, 2, 40000*10000, 30*10000, 14],
	[2044203, 1, 40000*10000, 50*10000, 15],
	//枪攻击必成卷
	[2044303, 1, 40000*10000, 50*10000, 7],
	[2044303, 2, 50000*10000, 30*10000, 8],
	[2044303, 1, 40000*10000, 50*10000, 9],
	//矛攻击必成卷
	[2044403, 1, 40000*10000, 50*10000, 3],
	[2044403, 2, 50000*10000, 30*10000, 4],
	[2044403, 1, 40000*10000, 50*10000, 5],
	//弓攻击必成卷
	[2044503, 1, 40000*10000, 50*10000, 13],
	[2044503, 2, 50000*10000, 30*10000, 14],
	[2044503, 1, 40000*10000, 50*10000, 15],
	//弩攻击必成卷
	[2044603, 1, 40000*10000, 50*10000, 17],
	[2044603, 2, 50000*10000, 30*10000, 18],
	[2044603, 1, 40000*10000, 50*10000, 19],
	//拳套攻击必成卷
	[2044703, 1, 40000*10000, 50*10000, 17],
	[2044703, 2, 50000*10000, 30*10000, 18],
	[2044703, 2, 40000*10000, 30*10000, 19],
	[2044703, 1, 40000*10000, 50*10000, 3],
	[2044703, 2, 50000*10000, 30*10000, 4],
	[2044703, 2, 40000*10000, 30*10000, 5],
	//指节攻击必成卷
	[2044815, 1, 40000*10000, 50*10000, 1],
	[2044815, 2, 50000*10000, 30*10000, 2],
	[2044815, 2, 40000*10000, 30*10000, 3],
	[2044815, 1, 40000*10000, 50*10000, 4],
	[2044815, 2, 50000*10000, 30*10000, 5],
	[2044815, 2, 40000*10000, 30*10000, 6],
	//短枪攻击必成卷
	[2044815, 1, 40000*10000, 50*10000, 12],
	[2044815, 2, 50000*10000, 30*10000, 2],
	[2044815, 2, 40000*10000, 30*10000, 3],
	[2044815, 1, 40000*10000, 50*10000, 4],
	[2044815, 2, 50000*10000, 30*10000, 5],
	[2044815, 2, 40000*10000, 30*10000, 6]

];



var sels;
var 脚本执行 = -1;

function start() {
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == 1) {
        脚本执行++;
    } else if (mode == 0) {
        脚本执行--;
    } else {
        cm.对话结束();
        return;
    }
	if (cm.getInventory(1).isFull()) {
        cm.说明文字("请保证 #b装备栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    } else if (cm.getInventory(2).isFull()) {
        cm.说明文字("请保证 #b消耗栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    } else if (cm.getInventory(3).isFull()) {
        cm.说明文字("请保证 #b设置栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    } else if (cm.getInventory(4).isFull()) {
        cm.说明文字("请保证 #b其他栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    } else if (cm.getInventory(5).isFull()) {
        cm.说明文字("请保证 #b特殊栏#k 至少有2个位置。");
        cm.对话结束();
        return;
    }
    if (脚本执行 == 0) {
        var 文本信息 = "";
        for (var i = 0; i < 贩售物品.length; i++) {
            if (hour == 贩售物品[i][4]) {
                文本信息 += "  #b#L" + i + "#";
                文本信息 += "" + cm.显示物品(贩售物品[i][0]) + " x " + 贩售物品[i][1] + "#l#k\r\n";
            }
        }
		if (文本信息 == "") {
			cm.说明文字("没有可出售的物品。");
            cm.对话结束();
            return;
        }
        cm.sendSimple("" + 说明文字 + "\r\n" + 文本信息 + "");
    } else if (脚本执行 == 1) {
        sels = selection;
        cm.是否说明文字("" + cm.显示物品(贩售物品[sels][0]) + " x " + 贩售物品[sels][1] + "需要:\r\n #v5200000##b 金币 x #d" + 贩售物品[sels][2] + "#k \r\n #v5440000##b 点券 x #d" + 贩售物品[sels][3]+ "#k");
    } else if (脚本执行 == 2) {
        if (贩售物品[sels][2] > 0) {
            if (cm.判断金币() < 贩售物品[sels][2]) {
                cm.说明文字("你的金币不够，");
                cm.对话结束();
                return;
            }
        }
        if (贩售物品[sels][3] > 0) {
            if (cm.判断点券() < 贩售物品[sels][3]) {
                cm.说明文字("你的点券不够，");
                cm.对话结束();
                return;
            }
        }
        cm.收金币(贩售物品[sels][2]);
        cm.收点券(贩售物品[sels][3]);
        cm.给物品(贩售物品[sels][0], 贩售物品[sels][1]);
        cm.说明文字("恭喜你购买了 " + cm.显示物品(贩售物品[sels][0]) + " x " + 贩售物品[sels][1] + "");
        cm.对话结束();
    } else {
        cm.说明文字("#r发生错误: mode : " + mode + " 脚本执行 : " + 脚本执行);
        cm.对话结束();
    }
}